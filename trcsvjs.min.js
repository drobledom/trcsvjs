/*!
	TRCSVJS
	v1.0.9
	https://github.com/drobledom/trcsvjs
	License: MIT
*/
if(void 0===Papa)var Papa=require("papaparse");!function(e,t,r){"function"==typeof define&&define.amd?define([],r):"object"==typeof module&&"undefined"!=typeof exports?module.exports=r(t,!0):e.Trcsvjs=r(t,!1)}(this,Papa,function(e,t){"use strict";var r="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==r?r:{},n={};function i(t,r,n){void 0===n&&(n=r,r={}),(r=r||{}).delimiter=void 0!==r.delimiter?r.delimiter:";",r.encoding=void 0!==r.encoding?r.encoding:"ISO-8859-1",r.complete=function(e,t){if(e.errors.length>0)return n(e.errors);var i={delimiter:e.meta.delimiter,newline:e.meta.linebreak};if("ISO-8859-1"==r.encoding)for(var s=e.data.length,c=0;c<s;c++)for(var a=e.data[c].length,f=0;f<a;f++)e.data[c][f]=e.data[c][f].toString("utf-8");var u=new o(i);u.initCsvFromArray(e.data),n(null,u)},e.parse(t,r)}n.csvStringToJs=i,n.getEmptyCsv=function(e){return new o(e)},n.getCsvFromFile=function(e,t,r){i(e,t,r)},n.getCsvFromUrl=function(e,t,r){void 0===r&&(r=t,t={});(t=t||{}).download=!0,i(e,t,r)};var o=function(e){e=e||{},this.delimiter=void 0!==e.delimiter?e.delimiter:";",this.newline=void 0!==e.newline&&""!=e.newline?e.newline:"\r\n",this._csv=[],this.number_of_rows=0,this.objspec={},this.emptyspec=""};o.prototype.initCsvFromArray=function(e){this._csv=e,this.number_of_rows=e.length},o.prototype.getRow=function(e,t){return e>this.number_of_rows||e<=0?t:this._csv[e-1]},o.prototype.getCell=function(e,t,r){return e>this.number_of_rows||e<=0||t>this._csv[e-1].length||t<=0?r:this._csv[e-1][t-1]},o.prototype.getObjFromRow=function(e,t,r){if(e>this.number_of_rows||e<=0)return{};void 0===t&&(t=this.objspec),void 0===r&&(r=this.emptyspec);var n=this.getRow(e),i={};return function e(t,r,n,i,o){for(var s in i){if(r>o)break;var a=i[s];"object"==typeof a?(n[s]={},r=e(t,r,n[s],a,o)):(n[s]=c(t[r],a),r++)}return r}(n,0,i,t,n.length),i},o.prototype.getRowFromObj=function(e,t,r){void 0===t&&(t=this.objspec),void 0===r&&(r=this.emptyspec);var n=[];return function e(t,r,n){for(var i in n){var o=n[i];"object"==typeof o?(void 0===r[i]&&(r[i]={}),e(t,r[i],o)):void 0===r[i]?t.push(""):t.push(a(r[i],o))}}(n,e,t),n},o.prototype.insertRow=function(e){this._csv.push(e),this.number_of_rows++},o.prototype.insertRowInPos=function(e,t){if(t<=this.number_of_rows)this._csv[t-1]=e;else{for(;t>this.number_of_rows;)this.insertRow([]);this._csv[t-1]=e}},o.prototype.setCell=function(e,t,r,n){if(!(e<=0||t<=0)){for(;e>this.number_of_rows;)this.insertRow([]);for(var i=this.getRow(e);t>i.length;)i.push([]);i[t-1]=r,this.insertRowInPos(i,e)}},o.prototype.insertRowFromObj=function(e,t,r){this._csv.push(this.getRowFromObj(e,t,r)),this.number_of_rows++},o.prototype.insertRowInPosFromObj=function(e,t,r,n){if(t<=this.number_of_rows)this._csv[t-1]=this.getRowFromObj(e,r,n);else{for(;t>this.number_of_rows;)this.insertRow([]);this._csv[t-1]=this.getRowFromObj(e,r,n)}},o.prototype.getCsvText=function(t){return void 0===(t=t||{}).delimiter&&(t.delimiter=this.delimiter),void 0!==t.newline&&""!=t.newline||(t.newline=this.newline),e.unparse(this._csv,t)};var s=65536;function c(e,t){var r;if(""==e&&["dz","fz","sc","bz"].indexOf(t)<0)return e;switch(t){case"ccy":return r=e,r=Math.round(100*parseFloat(r.replace(",",".")));case"d":case"dz":return parseInt(e);case"f":case"fz":return parseFloat(e.replace(",","."));case"b":return"1"==e;case"sc":e=e.split(",");for(var n=0;n<e.length;n++)e[n]=e[n].trim(),""==e[n]&&(e.splice(n,1),n--);return e;case"dt":var i=e.trim();return i.indexOf("/")>=0&&(i=(i=i.split("/"))[2]+"-"+i[1]+"-"+i[0]),i;default:return"string"==typeof e?e.trim():"number"==typeof e?e:""}}function a(e,t){var r;if(""==e&&["dz","fz","sc","bz"].indexOf(t)<0)return e;switch(t){case"ccy":return r=e,r=(parseInt(r)/100).toString().replace(".",",");case"d":case"dz":return parseInt(e).toString();case"f":case"fz":return e.toString().replace(".",",");case"b":case"bz":return e?"1":"0";case"sc":if("object"!=typeof e)return[];for(var n=0;n<e.length;n++)e[n]=e[n].trim(),""==e[n]&&(e.splice(n,1),n--);return e.join(",");case"dt":return" "+e+" ";default:return"string"==typeof e?e.trim():"number"==typeof e?e:""}}return o.prototype.browseCsv=function(e,r){if(t)return"";var n,i=function(e){var t,r;for(t="",r=e.length,i=0;i<r;)o=e.charCodeAt(i++),e[i-1],e.charAt(i-1),o<s&&(t+=e.charAt(i-1));for(var n=new Uint8Array(2*t.length),i=0;i<t.length;i++){var o=t.charCodeAt(i);t.charAt(i),n[2*i]=t.charCodeAt(i),n[2*i+1]=t.charCodeAt(i)>>8}return n}(this.getCsvText(r)),o=(n=new Blob([i],{type:"data:text/csv;charset=UTF-16LE"}),window.URL?window.URL.createObjectURL(n):window.webkitURL.createObjectURL(n)),c=document.createElement("a");c.setAttribute("href",o),c.setAttribute("download",e+".csv"),c.style.display="none",document.body.appendChild(c),c.click(),document.body.removeChild(c)},n});