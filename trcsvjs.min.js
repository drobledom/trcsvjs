/*!
	TRCSVJS
	v1.0.1
	https://github.com/drobledom/trcsvjs
	License: MIT
*/
if(void 0===Papa)var Papa=require("papaparse");!function(e,t,r){"function"==typeof define&&define.amd?define([],r):"object"==typeof module&&"undefined"!=typeof exports?module.exports=r(t,!0):e.Trcsvjs=r(t,!1)}(this,Papa,function(e,t){"use strict";function r(t,r,n){void 0===n&&(n=r,r={}),(r=r||{}).complete=function(e,t){if(e.errors.length>0)return n(e.errors);var r={delimiter:e.meta.delimiter,newline:e.meta.linebreak},o=new p(r);o.initCsvFromArray(e.data),n(null,o)},e.parse(t,r)}function n(e){var t,r,n,o;for(t="",r=e.length,s=0;s<r;){c=e.charCodeAt(s++);e[s-1],e.charAt(s-1);switch(c>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=e.charAt(s-1),1;break;case 12:case 13:n=e.charCodeAt(s++),t+=String.fromCharCode((31&c)<<6|63&n),t+=e.charAt(s-1),2;break;case 14:n=e.charCodeAt(s++),o=e.charCodeAt(s++),t+=String.fromCharCode((15&c)<<12|(63&n)<<6|(63&o)<<0),3;break;default:t+=e.charAt(s-1),4}}for(var i=new Uint8Array(2*t.length),s=0;s<t.length;s++){var c=t.charCodeAt(s);t.charAt(s);i[2*s]=t.charCodeAt(s),i[2*s+1]=t.charCodeAt(s)>>8}return i}function o(e){return window.URL?window.URL.createObjectURL(e):window.webkitURL.createObjectURL(e)}function i(e,t,r,n,o){for(var s in n){if(t>o)break;var a=n[s];"object"==typeof a?(r[s]={},t=i(e,t,r[s],a,o)):(r[s]=c(e[t],a),t++)}return t}function s(e,t,r){for(var n in r){var o=r[n];"object"==typeof o?(void 0===t[n]&&(t[n]={}),s(e,t[n],o)):void 0===t[n]?e.push(""):e.push(a(t[n],o))}}function c(e,t){var r=["dz","fz","sc"];if(""==e&&r.indexOf(t)<0)return e;switch(t){case"ccy":return f(e);case"d":case"dz":return parseInt(e);case"f":case"fz":return parseFloat(e.replace(",","."));case"b":return"1"==e;case"sc":e=e.split(",");for(var n=0;n<e.length;n++)e[n]=e[n].trim(),""==e[n]&&(e.splice(n,1),n--);return e;case"dt":var o=e.trim();return o.indexOf("/")>=0&&(o=(o=o.split("/"))[2]+"-"+o[1]+"-"+o[0]),o;default:return e.trim()}}function a(e,t){var r=["dz","fz","sc"];if(""==e&&r.indexOf(t<0))return e;switch(t){case"ccy":return u(e);case"d":case"dz":return parseInt(e).toString();case"f":case"fz":return e.toString().replace(".",",");case"b":return e?"1":"0";case"sc":if("object"!=typeof e)return[];for(var n=0;n<e.length;n++)e[n]=e[n].trim(),""==e[n]&&(e.splice(n,1),n--);return e.join(",");case"dt":return" "+e+" ";default:return e.trim()}}function u(e){return e=(parseInt(e)/100).toString().replace(".",",")}function f(e){return e=Math.round(100*parseFloat(e.replace(",",".")))}var h="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==h?h:{},d={};d.csvStringToJs=r,d.getEmptyCsv=function(e){return new p(e)},d.getCsvFromFile=function(e,t,n){r(e,t,n)},d.getCsvFromUrl=function(e,t,n){void 0===n&&(n=t,t={}),(t=t||{}).download=!0,r(e,t,n)};var p=function(e){e=e||{},this.delimiter=void 0!==e.delimiter?e.delimiter:";",this.newline=void 0!==e.newline&&""!=e.newline?e.newline:"\r\n",this._csv=[],this.number_of_rows=0,this.objspec={},this.emptyspec=""};return p.prototype.initCsvFromArray=function(e){this._csv=e,this.number_of_rows=e.length},p.prototype.getRow=function(e,t){return e>this.number_of_rows||e<=0?t:this._csv[e-1]},p.prototype.getCell=function(e,t,r){return e>this.number_of_rows||e<=0||t>this._csv[e-1].length||t<=0?r:this._csv[e-1][t-1]},p.prototype.getObjFromRow=function(e,t,r){if(e>this.number_of_rows||e<=0)return{};void 0===t&&(t=this.objspec),void 0===r&&(r=this.emptyspec);var n=this.getRow(e),o={};return i(n,0,o,t,n.length),o},p.prototype.getRowFromObj=function(e,t,r){void 0===t&&(t=this.objspec),void 0===r&&(r=this.emptyspec);var n=[];return s(n,e,t,r),n},p.prototype.insertRow=function(e){this._csv.push(e),this.number_of_rows++},p.prototype.insertRowInPos=function(e,t){if(t<=this.number_of_rows)this._csv[t-1]=e;else{for(;t>this.number_of_rows;)this.insertRow([]);this._csv[t-1]=e}},p.prototype.setCell=function(e,t,r,n){if(!(e<=0||t<=0)){for(;e>this.number_of_rows;)this.insertRow([]);for(var o=this.getRow(e);t>o.length;)o.push([]);o[t-1]=r,this.insertRowInPos(o,e)}},p.prototype.insertRowFromObj=function(e,t,r){this._csv.push(this.getRowFromObj(e,t,r)),this.number_of_rows++},p.prototype.insertRowInPosFromObj=function(e,t,r,n){if(t<=this.number_of_rows)this._csv[t-1]=this.getRowFromObj(e,r,n);else{for(;t>this.number_of_rows;)this.insertRow([]);this._csv[t-1]=this.getRowFromObj(e,r,n)}},p.prototype.getCsvText=function(t){return void 0===(t=t||{}).delimiter&&(t.delimiter=this.delimiter),void 0!==t.newline&&""!=t.newline||(t.newline=this.newline),e.unparse(this._csv,t)},p.prototype.browseCsv=function(e,r){if(t)return"";var i=n(this.getCsvText(r)),s=o(new Blob([i],{type:"data:text/csv;charset=UTF-16LE"})),c=document.createElement("a");c.setAttribute("href",s),c.setAttribute("download",e+".csv"),c.style.display="none",document.body.appendChild(c),c.click(),document.body.removeChild(c)},d});